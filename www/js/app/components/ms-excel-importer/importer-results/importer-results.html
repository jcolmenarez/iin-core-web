<section class="component-container" id="ms-excel-importer-results-container">

    <!--div class="loading-container" ng-show="$ctrl.isLoading">
        <span>
            <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
            Loading...
        </span>
    </div-->

    <div class="results-container" ng-if="$ctrl.showingResults">

        <p class="results-list-title">Results List:</p>
        <ul>
            <li ng-class="{
                    'pending': !result.isComplete,
                    'error': result.isComplete && result.isError,
                    'success': result.isComplete && !result.isError
                }" ng-repeat="result in $ctrl.results">
                <i ng-class="[
                        'fa',
                        'fa-li',
                        {
                            'fa-exclamation-circle': result.isComplete && result.isError,
                            'fa-check-circle': result.isComplete && !result.isError,
                            'fa-pulse fa-spinner fa-fw': !result.isComplete
                        }
                    ]"></i><span ng-class="{'status-entry': !$first}" ng-repeat="status in result.messages">{{ status }}</span>
            </li>
        </ul>

        <a ng-class="['download-results-log', {'disabled': !$ctrl.isProcessingCompleted}]" ng-href="{{ $ctrl.resultsList() }}" download="results-log.txt">
            <i class="fa fa-arrow-down"></i>
            Download results log file
        </a>

    </div>

    <form id="db-config-form" ng-if="!$ctrl.showingResults">

        <button class="btn btn-primary" id="update-db-config-btn" type="button" ng-click="$ctrl.shouldUpdateDBConfig()">
            <i class="fa fa-database"></i>
            {{ !$ctrl.dbConfigHasChanged ? 'Update DB Configuration' : 'Use default DB Configuration' }}
        </button>

        <div class="form-control-group" ng-show="$ctrl.dbConfigHasChanged" ng-repeat="(key, value) in $ctrl.dbNewConfig">

            <label for="{{ key }}">{{ $ctrl.dbConfigFieldsInfo[key].name }}</label>
            <input ng-model="$ctrl.dbNewConfig[key]" name="{{ key }}" placeholder="{{ $ctrl.dbConfigFieldsInfo[key].placeholder }}" type="{{ $ctrl.dbConfigFieldsInfo[key].type }}" />

        </div>

    </form>

    <h3 ng-if="!$ctrl.showingResults">{{ ::$ctrl.title }}</h3>

    <table class="table table-striped" ng-if="!$ctrl.showingResults">

        <thead>
        
            <th ng-if="$ctrl.isEventPromoCodeMode">Event IDs</th>
            <th>Student IDs</th>
            <th ng-if="$ctrl.isEventPromoCodeMode">Promo Codes</th>
            <th ng-if="$ctrl.isEventPromoCodeMode">Activated</th>

        </thead>
        
        <tbody>
        
            <tr ng-repeat="row in $ctrl.excelData">

                <td ng-if="$ctrl.isEventPromoCodeMode">{{ ::row.EventId }}</td>
                <td>{{ ::row.StudentId }}</td>
                <td ng-if="$ctrl.isEventPromoCodeMode">{{ ::row.PromotionCode }}</td>
                <td ng-if="$ctrl.isEventPromoCodeMode">{{ ::row.Activated }}</td>

            </tr>

        </tbody>

    </table>

    <button class="btn btn-upload" ng-click="$ctrl.submitExcelData()" ng-if="!$ctrl.showingResults" type="button">
        <i class="fa fa-arrow-up"></i>
        Submit Excel data
    </button>

</section>